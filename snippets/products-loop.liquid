{% comment %} CUSTOM FORLOOP OF PRODUCTS {% endcomment %}


{%- liquid
  assign datalayer_collection_handle = collection.handle
  assign datalayer_collection_title = collection.title
-%}

<script type='application/javascript'>
  window.datalayer_view_item_list["{{ datalayer_collection_handle }}"] = {
    name: "{{ datalayer_collection_title }}", items: []
  };
</script>

{%- for product in collection.products offset: offset -%}
  {% assign lazy_load = false %}
  {%- if forloop.index > 2 -%}
    {%- assign lazy_load = true -%}
  {%- endif -%}
  <li
    class="grid__item{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
    {% if settings.animations_reveal_on_scroll %}
      data-cascade
      style="--animation-order: {{ forloop.index }};"
    {% endif %}
  >
    {% render 'card-product',
      card_product: product,
      media_aspect_ratio: section.settings.image_ratio,
      image_shape: section.settings.image_shape,
      show_secondary_image: section.settings.show_secondary_image,
      show_vendor: section.settings.show_vendor,
      show_rating: section.settings.show_rating,
      lazy_load: lazy_load,
      show_quick_add: section.settings.enable_quick_add,
      section_id: section.id,
      datalayer_collection_handle: datalayer_collection_handle
    %}
  </li>
{%- endfor -%}
